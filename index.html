<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NEP Result Calculator (with Grace)</title>
<style>
body { font-family: Arial, sans-serif; background:#f7f9fb; padding:10px; margin:0; }
h1 { text-align:center; font-size:1.4em; margin-bottom:5px; }
h2 { font-size:1em; margin-top:15px; margin-bottom:8px; }
.description { text-align:center; margin-bottom:10px; font-size:0.9em; font-weight:bold; }
.owner { text-align:center; font-size:0.8em; margin-bottom:15px; }
.subject-section { margin-bottom:15px; border:1px solid #ccc; border-radius:5px; padding:10px; background:#fff; }
.subject { margin-bottom:8px; display:flex; flex-wrap:wrap; align-items:center; }
.subject label { width:100%; margin-bottom:5px; font-weight:bold; }
.subject input[type=number] { width:70px; margin-right:10px; margin-bottom:5px; }
button { padding:6px 12px; margin:5px 5px 5px 0; cursor:pointer; background:#007BFF; color:#fff; border:none; border-radius:5px; font-size:0.85em; transition:0.3s; }
button:hover { background:#0056b3; transform:scale(1.05); }
table { width:100%; border-collapse: collapse; margin-top:15px; font-size:0.85em; }
thead { background:#f0f0f0; }
th, td { border:1px solid #ccc; padding:6px; text-align:center; }
.pass { color:green; font-weight:bold; }
.fail { color:red; font-weight:bold; }
.grace { color:red; font-weight:bold; }
.graceApplied { background:#fff0f0; } 
#overall { font-size:1.1em; text-align:center; margin-top:10px; font-weight:bold; }
.collapseContent { display:none; }
@media(max-width:600px){
  .subject { flex-direction: column; align-items: flex-start; }
  .subject input[type=number] { width:100%; }
  table { font-size:0.75em; }
  th, td { padding:4px; }
}
</style>
</head>
<body>

<h1>NEP Result Calculator (with Grace)</h1>
<div class="description">
Only for NEP BA, B.Sc, B.Com Students <br><br>
यह CCS University Meerut की कोई अधिकारिक साईट/ऐप नहीं है। केवल एनईपी 
रिजल्ट में Grace Marks की गणना करने के लिये व्यक्तिगत रूप से बनाया गया है। 
यह केवल सूचना मात्र के लिये है। रिजल्ट गणना में त्रुटि सम्भव है।
</div>

<div class="owner">
<b>Aaditya Chaudhary</b> <br>
Owner <br>
Telegram Channel: <a href="https://t.me/CCSUniversityMRT" target="_blank">t.me/CCSUniversityMRT</a> 
<br><br>
<b>Sanjeev Chauhan</b> <br>
Owner <br>
Telegram Channel: <a href="https://t.me/ccsnewsupdates" target="_blank">t.me/ccsunewsupdates</a>
</div>

<!-- Major Theory -->
<div class="subject-section">
<h2>Major Theory Subjects (Enter Marks)</h2>
<div id="majorTheorySubjects"></div>
<button onclick="addMajorTheory()">Add More Major Theory Subjects</button>
</div>

<!-- Major Practical -->
<div class="subject-section">
<h2>Major Practical Subjects (Click to Add)</h2>
<div id="majorPracticalSubjects"></div>
<button onclick="addMajorPractical()">Add Major Practical Subjects</button>
</div>

<!-- Minor -->
<div class="subject-section">
<h2>Minor Subject (Click to Add)</h2>
<div id="minorSubjects"></div>
<button onclick="addMinor()">Add Minor Subjects</button>
</div>

<!-- Skill -->
<div class="subject-section">
<h2>Skill Development (Click to Add)</h2>
<div id="skillSubjects"></div>
<button onclick="addSkill()">Add Skill Development</button>
</div>

<!-- Co-Curricular -->
<div class="subject-section">
<h2>Co-Curricular (Enter Marks)</h2>
<div class="subject">
<label>Co-Curricular 1:</label>
External <input type="number" min="0" max="75" class="coExternal">
Internal <input type="number" min="0" max="25" class="coInternal">
</div>
</div>

<!-- Project -->
<div class="subject-section">
<h2>Project (Click to Add)</h2>
<div id="projectSubjects"></div>
<button onclick="addProject()">Add Project</button>
</div>

<!-- Action Buttons -->
<div style="text-align:center; margin-top:10px;">
<button onclick="calculateResult()">Calculate Result</button>
<button onclick="resetForm()">Reset</button>
</div>

<!-- Result Table -->
<table id="resultTable">
<thead>
<tr>
<th>Subject</th>
<th>External</th>
<th>Grace</th>
<th>External after Grace</th>
<th>Internal</th>
<th>Total</th>
<th>Status</th>
<th>Marks Short of Pass</th>
</tr>
</thead>
<tbody></tbody>
</table>

<div id="overall"></div>

<script>
let majorTheoryCount=0, majorPracticalCount=0, minorCount=0, skillCount=0, projectCount=0;
const maxGrace=5, maxGraceSubjects=3;

// Default 3 Major Theory
for(let i=0;i<3;i++) addMajorTheory();

function addSubject(containerId,name,extClass,intClass,label1="External",label2="Internal"){
  const container=document.getElementById(containerId);
  container.style.display="block";
  const div=document.createElement("div");
  div.className="subject";
  div.innerHTML=`<label>${name}:</label>
  ${label1} <input type="number" class="${extClass}" min="0">`+
  (intClass?` ${label2} <input type="number" class="${intClass}" min="0">`:"");
  container.appendChild(div);
}

function addMajorTheory(){ majorTheoryCount++; addSubject("majorTheorySubjects","Major Theory "+majorTheoryCount,"majorTheoryExternal","majorTheoryInternal"); }
function addMajorPractical(){ majorPracticalCount++; addSubject("majorPracticalSubjects","Major Practical "+majorPracticalCount,"majorPracticalExternal","majorPracticalInternal"); }
function addMinor(){ minorCount++; addSubject("minorSubjects","Minor "+minorCount,"minorExternal","minorInternal"); }

// Skill Development = Theory + Practical
function addSkill(){ 
  skillCount++; 
  addSubject("skillSubjects","Skill Development "+skillCount,"skillTheory","skillPractical","Theory","Practical"); 
}

// Project = Only Total
function addProject(){ 
  projectCount++; 
  addSubject("projectSubjects","Project "+projectCount,"projectMarks",null,"Total",""); 
}

function calculateResult(){
  const tbody=document.querySelector("#resultTable tbody");
  tbody.innerHTML="";
  let graceLeft=maxGrace, remainingGraceSubjects=maxGraceSubjects;
  let subjects=[];

  [
    ["majorTheoryExternal","majorTheoryInternal","majorTheory","Major Theory"],
    ["majorPracticalExternal","majorPracticalInternal","majorPractical","Major Practical"],
    ["minorExternal","minorInternal","minor","Minor"],
    ["skillTheory","skillPractical","skill","Skill Development"],
    ["projectMarks",null,"project","Project"]
  ].forEach(([extClass,intClass,type,displayName])=>{
    const extInputs=document.querySelectorAll("."+extClass);
    const intInputs=intClass?document.querySelectorAll("."+intClass):[];
    extInputs.forEach((el,i)=>{
      const ext=Number(el.value)||0;
      const intr=intClass?Number(intInputs[i].value)||0:0;
      if(ext!==0 || intr!==0){
        subjects.push({name:`${displayName} ${i+1}`,ext,internal:intr,type,grace:0, initialPass:false});
      }
    });
  });

  const coExt=Number(document.querySelector(".coExternal").value)||0;
  const coInt=Number(document.querySelector(".coInternal").value)||0;
  if(coExt || coInt) subjects.push({name:"Co-Curricular",ext:coExt,internal:coInt,type:"coCurricular",grace:0,initialPass:false});

  function checkPass(subj,extTotal){
    const total=subj.internal+extTotal;
    if(subj.type==="majorTheory"||subj.type==="minor"||subj.type==="majorPractical") return (extTotal>=25 && total>=33);
    if(subj.type==="skill"||subj.type==="coCurricular"||subj.type==="project") return total>=40;
    return false;
  }

  subjects.forEach(subj=>{ subj.initialPass = checkPass(subj,subj.ext); });

  subjects.forEach(subj=>{
    if(graceLeft<=0 || remainingGraceSubjects<=0) return;
    if(subj.type==="majorTheory"||subj.type==="minor"||subj.type==="coCurricular"){
      let needGrace=0;
      const total=subj.ext+subj.internal;
      if(subj.type==="majorTheory"||subj.type==="minor"){
        if(subj.ext<25 || total<33) needGrace=Math.min(maxGrace,25-subj.ext);
      } else if(subj.type==="coCurricular"){
        if(total<40) needGrace=Math.min(maxGrace,75-subj.ext);
      }
      if(needGrace>0){
        const applied=Math.min(needGrace,graceLeft);
        subj.ext+=applied; subj.grace+=applied;
        graceLeft-=applied; remainingGraceSubjects--;
      }
    }
  });

  let anyFailAfterGrace=false;
  subjects.forEach(subj=>{ if(!checkPass(subj,subj.ext)) anyFailAfterGrace=true; });

  subjects.forEach(subj=>{
    const total=subj.ext+subj.internal;
    let status=checkPass(subj,subj.ext)?"Pass":"Fail";
    if(subj.initialPass && subj.grace===0) status="Pass";
    if(anyFailAfterGrace && !subj.initialPass && subj.grace>0) status="Fail";

    let short=0;
    if(status==="Fail"){
      if(subj.type==="majorTheory"||subj.type==="minor"||subj.type==="majorPractical")
        short=Math.max(0,33-total,25-(subj.ext-subj.grace));
      else short=Math.max(0,40-total);
    }

    const tr=document.createElement("tr");
    tr.className=subj.grace>0?"graceApplied":"";
    tr.innerHTML=`<td>${subj.name}</td>
    <td>${subj.ext-subj.grace}</td>
    <td class="grace">${subj.grace}</td>
    <td>${subj.ext}</td>
    <td>${subj.internal}</td>
    <td>${total}</td>
    <td class="${status==='Pass'?'pass':'fail'}">${status}</td>
    <td>${short>0?short:0}</td>`;
    tbody.appendChild(tr);
  });

  const failMessage='Fail (ग्रेस मिलने के बाद भी यदि किसी भी विषय में बैक रहती है तो किसी भी विषय में ग्रेस नहीं मिलेगा)';
  document.getElementById("overall").innerHTML=anyFailAfterGrace?`Overall Result: <span class="fail">${failMessage}</span>`:`Overall Result: <span class="pass">PASS</span>`;
}

function resetForm(){ location.reload(); }
</script>

</body>
</html>
